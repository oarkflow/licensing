# PHP SDK - Basic Example

This example demonstrates how to use the PHP Licensing SDK to:

1. Load credentials from a JSON file
2. Load and decrypt a stored license file
3. Check license validity and expiration
4. Access license data and check features/scopes

## Prerequisites

- PHP 8.1 or later
- Composer dependencies installed
- A valid license file (`.license.dat`) generated by the Go SDK client
- Or a credentials JSON file

## Setup

```bash
# Install dependencies (from the SDK root)
cd ../..
composer install
```

## Usage

### Verify a License File

```bash
php index.php --license-file ~/.licensing-example/.license.dat

# Or with short option
php index.php -l ~/.licensing-example/.license.dat
```

### Load Credentials File

```bash
php index.php --credentials-file ./license-credentials.json

# Or with short option
php index.php -c ./license-credentials.json
```

### Credentials File Format

Create a JSON file with your license credentials:

```json
{
  "email": "user@example.com",
  "client_id": "client-123",
  "license_key": "XXXX-XXXX-XXXX-XXXX-XXXX-XXXX-XXXX-XXXX"
}
```

## Example Output

```
=== PHP Licensing SDK - Basic Example ===

üìÑ Loading license from: ~/.licensing-example/.license.dat
üîç Verifying signature...
üîì Decrypting license...
‚úÖ License verified and decrypted!

=== License Information ===
ID:            lic_abc123
Email:         john@example.com
Client ID:     client-xyz
Plan:          enterprise
Issued:        2025-01-01 00:00:00
Expires:       2026-01-01 00:00:00
Max Devices:   3
Activations:   1
Check Mode:    each_execution

=== Feature Entitlements ===
Product: my-saas-app
Plan:    enterprise

  Feature: gui - ‚úÖ Enabled
    - list: allow
    - create: allow
    - update: allow
    - delete: allow
  Feature: cli - ‚úÖ Enabled
    - execute: allow
  Feature: api - ‚úÖ Enabled
    - requests: limit (limit: 10000)

=== Feature Checks ===
‚úÖ Feature 'gui' is available
‚úÖ Feature 'cli' is available
‚úÖ Feature 'api' is available
‚ùå Feature 'premium' is not available

=== Scope Checks ===
‚úÖ Can gui:list
‚úÖ Can gui:create
‚úÖ Can gui:update
‚úÖ Can gui:delete
‚ùå Cannot api:read
‚ùå Cannot api:write

=== Done ===
```

## Note

This SDK currently focuses on **license verification** (decrypting and validating stored license files). For full activation flow (generating device fingerprint, contacting the server), use the Go SDK which provides the complete client implementation.

The workflow is:
1. Use Go SDK to activate and store the license (`.license.dat`)
2. Use this PHP SDK to verify and check features in your PHP application

## Using in Your Application

```php
<?php
require_once 'vendor/autoload.php';

use Oarkflow\Licensing\License;

// Load and verify license
$stored = json_decode(file_get_contents('.license.dat'), true);
$result = License::decrypt($stored);
$license = $result['license'];

// Check features
if (License::hasFeature($license, 'api')) {
    // API feature is enabled
}

// Check scopes
if (License::hasScope($license, 'gui', 'create')) {
    // User can create via GUI
}

// Check with limits
$result = License::canPerform($license, 'api', 'requests');
if ($result['allowed']) {
    echo "API requests allowed";
    if ($result['limit'] > 0) {
        echo " (limit: {$result['limit']})";
    }
}
```

## API Reference

See the main [PHP SDK README](../../README.md) for complete API documentation.
